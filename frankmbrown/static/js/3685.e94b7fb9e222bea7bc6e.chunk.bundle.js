"use strict";(self.webpackChunkbundled_client_code=self.webpackChunkbundled_client_code||[]).push([[3685],{13685:function(t,e,n){n.r(e),n.d(e,{addAudioOnChange:function(){return Le},addGifOnChange:function(){return Ue},addImageOnChange:function(){return ve},addVideoOnChange:function(){return we},closeAudioDialog:function(){return tt},closeImageDialog:function(){return $},closeMediaStream:function(){return B},closeVideoDialog:function(){return et},deleteImage:function(){return me},getAudioHTML:function(){return te},getClientImageData:function(){return ke},getImageWidthAndHeight:function(){return Wt},getImageWidthAndHeightFromImage:function(){return Kt},getVideoHTML:function(){return ee},getVideoWidthAndHeight:function(){return Ft},getVideoWidthAndHeightFromVideo:function(){return Rt},handleAudioError:function(){return xe},handleAudioUpload:function(){return Se},handleImageError:function(){return re},handleImageUpload:function(){return pe},handlePageChangeMediaInputs:function(){return Me},handleVideoError:function(){return ge},handleVideoUpload:function(){return Ae},onLoadSetUploadMediaListeners:function(){return Lt},resolveVideoWidthAndHeight:function(){return Ot},setAudioDefaultTitle:function(){return ne},setFileUploadListeners:function(){return Te},setVideoDefaultTitle:function(){return ae}});var a,r=n(60429),i=n(95361),o=n(52425),c=function(t,e,n,a){return new(n||(n=Promise))((function(r,i){function o(t){try{d(a.next(t))}catch(t){i(t)}}function c(t){try{d(a.throw(t))}catch(t){i(t)}}function d(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,c)}d((a=a.apply(t,e||[])).next())}))},d=function(t,e){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(d){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(o=0)),o;)try{if(n=1,a&&(r=2&c[0]?a.return:c[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,c[1])).done)return r;switch(a=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,a=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=e.call(t,o)}catch(t){c=[6,t],a=0}finally{n=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,d])}}},s=null===(a=null===navigator||void 0===navigator?void 0:navigator.mediaDevices)||void 0===a?void 0:a.getSupportedConstraints(),u=(0,r.CN)()&&s&&Boolean(new Set(Object.keys(s)).has("facingMode"));function l(t){return c(this,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,this.play().catch((function(t){return console.error(t)}))];case 1:return t.sent(),[2]}}))}))}var p={},v=void 0,m=void 0,h=void 0,f=[],b=void 0,g="user",y="user",A=void 0,w=void 0,x=0,E=!0,S=!0,L=!0,U=function(){return document.getElementById("upload-image-popover")},T=function(){return document.getElementById("upload-audio-popover")},M=function(){return document.getElementById("upload-video-popover")};function k(){var t=document.getElementById("upload-image-dialog");if(t){var e=t.querySelector("input[data-multiple]"),n=t.querySelector("button[data-preview]"),a=t.querySelector("button#take-image-button"),r=t.querySelector("form#upload-image-form"),i=t.querySelector("div[data-loader]"),o=t.querySelector('output[form="upload-image-form"]'),c=t.querySelector("video"),d=t.querySelector("div[data-actions]"),s=t.querySelector("button[data-switch-camera]");if(t&&e&&n&&a&&r&&i&&o&&c&&d&&s)return{dialog:t,multiple:e,preview:n,takeImage:a,form:r,loader:i,output:o,video:c,actions:d,switchCameraButton:s}}return null}function z(){var t=document.getElementById("upload-audio-dialog");if(t){var e=t.querySelector("input[data-multiple]"),n=t.querySelector("button[data-preview]"),a=t.querySelector("button#record-audio-button"),r=t.querySelector("form#upload-audio-form"),i=t.querySelector("div[data-loader]"),o=t.querySelector('output[form="upload-audio-form"]'),c=t.querySelector("audio"),d=t.querySelector("span[data-time]"),s=t.querySelector("div[data-actions]");if(t&&e&&n&&a&&r&&i&&o&&c&&d&&s)return{dialog:t,multiple:e,preview:n,recordAudio:a,form:r,loader:i,output:o,audio:c,time:d,actions:s}}return null}function I(){var t=document.getElementById("upload-video-dialog");if(t){var e=t.querySelector("input[data-multiple]"),n=t.querySelector("button[data-preview]"),a=t.querySelector("button#take-video-button"),r=t.querySelector("form#upload-video-form"),i=t.querySelector("div[data-loader]"),o=t.querySelector('output[form="upload-video-form"]'),c=t.querySelector("video"),d=t.querySelector("span[data-time]"),s=t.querySelector("div[data-actions]"),u=t.querySelector("button[data-switch-camera]");if(e&&n&&a&&r&&i&&o&&c&&d&&s&&u)return{dialog:t,multiple:e,preview:n,recordVideo:a,form:r,loader:i,output:o,video:c,time:d,actions:s,switchCameraButton:u}}return null}function H(){if(p["upload-image-popover"])try{p["upload-image-popover"](),delete p["upload-image-popover"];var t=U();t&&(t.style.display="none",t.style.opacity="0")}catch(t){}}function q(){if(p["upload-audio-popover"])try{p["upload-audio-popover"](),delete p["upload-audio-popover"];var t=T();t&&(t.style.display="none",t.style.opacity="0")}catch(t){}}function C(){if(p["upload-video-popover"])try{p["upload-video-popover"](),delete p["upload-video-popover"];var t=M();t&&(t.style.display="none",t.style.opacity="0")}catch(t){}}function V(){H(),q(),C(),this.removeEventListener("click",V)}function N(t,e,n){var a=(0,r.jE)(t);a&&a.addEventListener("click",V),e.addEventListener("click",r.no),e.style.display="block";var c=function(){var n=[],a={};e.classList,n.push((0,i.cY)(1)),n.push((0,o.BN)()),null===e.getAttribute("data-no-flip")&&n.push((0,o.UU)()),a.placement="bottom-start",a.middleware=n,(0,o.rD)(t,e,a).then((function(t){var n,a=t.x,r=t.y;n={left:"".concat(a,"px"),top:"".concat(r,"px"),opacity:"1"},Object.assign(e.style,n)})).catch((function(t){console.error(t),Object.assign(e.style,{left:"0px",top:"0px",opacity:"0"}),e.setAttribute("hidden","")}))};c();var d=(0,o.ll)(t,e,c);"image"===n?(delete p["upload-image-popover"],p["upload-image-popover"]=d):"audio"===n?(delete p["upload-audio-popover"],p["upload-audio-popover"]=d):"video"===n&&(delete p["upload-video-popover"],p["upload-video-popover"]=d)}function B(){w=void 0,v&&(v.getTracks().forEach((function(t){return t.stop()})),v=void 0),b&&(b=void 0),m&&(m=void 0),h&&(h.stop(),h=void 0)}var P=void 0,D=void 0,j=void 0;function _(){return P&&P.isConnected?P:(P=void 0,null)}function O(){return D&&D.isConnected?D:(D=void 0,null)}function R(){return j&&j.isConnected?j:(j=void 0,null)}function F(t){if(E){t.preventDefault(),t.stopPropagation(),this.getAttribute("name")&&(P=this);var e=U();e&&N(this,e,"image")}else E=!0}function K(t){if(S){t.preventDefault(),t.stopPropagation(),this.getAttribute("name")&&(D=this);var e=T();e&&N(this,e,"audio")}else S=!0}function W(t){if(L){t.preventDefault(),t.stopPropagation(),this.getAttribute("name")&&(j=this);var e=M();e&&N(this,e,"video")}else L=!0}function G(){E=!1;var t=_();t&&t.click(),H()}function J(){S=!1;var t=O();t&&t.click(),q()}function X(){L=!1;var t=R();t&&t.click(),C()}function Q(t){var e=k(),n=_();if(e&&n){var a=e.dialog,i=e.form,o=e.loader,c=e.output,d=e.multiple,s=e.video,p=e.switchCameraButton,h=n.hasAttribute("multiple");i.setAttribute("hidden",""),c.innerHTML="",c.setAttribute("hidden",""),o.removeAttribute("hidden"),u?p.removeAttribute("hidden"):p.setAttribute("hidden",""),d.value=String(h),s.srcObject=null,B(),(0,r.Dh)(a),w=void 0,g="user",navigator.mediaDevices.getUserMedia({video:{facingMode:g}}).then((function(t){v=t,s.srcObject=v,s.addEventListener("pause",l);var e=v.getVideoTracks()[0];if("ImageCapture"in window)try{m=new ImageCapture(e)}catch(t){console.error(t),m=void 0,(0,r.zU)(a),re(6)}o.setAttribute("hidden",""),i.removeAttribute("hidden")})).catch((function(t){(0,r.zU)(a),re(6),i.setAttribute("hidden",""),c.innerHTML="",c.setAttribute("hidden",""),o.setAttribute("hidden","")})),H()}}function Y(t){var e=z(),n=O();if(e&&n){var a=e.dialog,i=e.form,o=e.loader,c=e.output,d=e.multiple,s=e.audio,u=n.hasAttribute("multiple");i.setAttribute("hidden",""),c.innerHTML="",c.setAttribute("hidden",""),o.removeAttribute("hidden"),d.value=String(u),s.srcObject=null,B(),(0,r.Dh)(a),w="audio",navigator.mediaDevices.getUserMedia({audio:!0}).then((function(t){v=t,s.srcObject=v,s.volume=0,o.setAttribute("hidden",""),i.removeAttribute("hidden")})).catch((function(t){(0,r.zU)(a),xe(6),i.setAttribute("hidden",""),c.innerHTML="",c.setAttribute("hidden",""),o.setAttribute("hidden","")})),q()}}function Z(t){var e=I(),n=R();if(e&&n){var a=e.dialog,i=e.form,o=e.loader,c=e.output,d=e.multiple,s=e.video,p=e.switchCameraButton,m=n.hasAttribute("multiple");i.setAttribute("hidden",""),c.innerHTML="",c.setAttribute("hidden",""),o.removeAttribute("hidden"),u?p.removeAttribute("hidden"):p.setAttribute("hidden",""),d.value=String(m),s.srcObject=null,B(),(0,r.Dh)(a),w="video",y="user",navigator.mediaDevices.getUserMedia({video:{facingMode:y},audio:!0}).then((function(t){v=t,s.srcObject=v,s.addEventListener("pause",l),s.volume=0,o.setAttribute("hidden",""),i.removeAttribute("hidden")})).catch((function(t){(0,r.zU)(a),ge(6),i.setAttribute("hidden",""),c.innerHTML="",c.setAttribute("hidden",""),o.setAttribute("hidden","")})),C()}}function $(){var t=k();if(t){var e=t.form,n=t.loader,a=t.output,r=t.video,i=t.actions;r.srcObject=null,B(),e.setAttribute("hidden",""),n.setAttribute("hidden",""),a.setAttribute("hidden",""),i.setAttribute("hidden","")}}function tt(){var t=z();if(t){var e=t.audio,n=t.output,a=t.form,r=t.loader,i=t.actions,o=t.recordAudio,c=t.time;e.srcObject=null,B(),a.setAttribute("hidden",""),r.setAttribute("hidden",""),n.setAttribute("hidden",""),i.setAttribute("hidden",""),c.innerText="0:00",o.classList.remove("recording")}}function et(){var t=I();if(t){var e=t.video,n=t.output,a=t.form,r=t.loader,i=t.actions,o=t.recordVideo,c=t.time;e.srcObject=null,B(),a.setAttribute("hidden",""),r.setAttribute("hidden",""),n.setAttribute("hidden",""),i.setAttribute("hidden",""),c.innerText="0:00",o.classList.remove("recording")}}function nt(t){return c(this,void 0,void 0,(function(){var e,n,a,i,o,c,s;return d(this,(function(d){switch(d.label){case 0:return t.preventDefault(),t.stopPropagation(),e=_(),(n=k())&&e?(a=n.dialog,i=document.querySelector('output[for="'.concat(String(e.getAttribute("name")),'"]')),b&&i?(A=structuredClone(b),(0,r.zU)(a),Array.isArray(A)?[4,pe(A,i,e)]:[3,2]):[3,5]):[3,6];case 1:return d.sent(),[3,4];case 2:return[4,pe([A],i,e)];case 3:d.sent(),d.label=4;case 4:for(o=new DataTransfer,c=Array.isArray(A)?A:[A],s=0;s<c.length&&(o.items.add(c[s]),e.hasAttribute("multiple"));s++);return e.files=o.files,[3,6];case 5:(0,r.zU)(a),d.label=6;case 6:return[2]}}))}))}function at(t){return c(this,void 0,void 0,(function(){var e,n,a,i;return d(this,(function(o){switch(o.label){case 0:return t.preventDefault(),t.stopPropagation(),e=O(),(n=z())&&e?(a=n.dialog,i=document.querySelector('output[for="'.concat(String(e.getAttribute("name")),'"]')),b&&i?(A=structuredClone(b),(0,r.zU)(a),Array.isArray(A)?[4,Se(A,e,i)]:[3,2]):[3,5]):[3,6];case 1:return o.sent(),[3,4];case 2:return[4,Se([A],e,i)];case 3:o.sent(),o.label=4;case 4:return[3,6];case 5:(0,r.zU)(a),o.label=6;case 6:return[2]}}))}))}function rt(t){return c(this,void 0,void 0,(function(){var e,n,a,i;return d(this,(function(o){switch(o.label){case 0:return t.preventDefault(),t.stopPropagation(),e=R(),(n=I())&&e?(a=n.dialog,i=document.querySelector('output[for="'.concat(String(e.getAttribute("name")),'"]')),b&&i?(A=structuredClone(b),(0,r.zU)(a),Array.isArray(A)?[4,Ae(A,e,i)]:[3,2]):[3,5]):[3,6];case 1:return o.sent(),[3,4];case 2:return[4,Ae([A],e,i)];case 3:o.sent(),o.label=4;case 4:return[3,6];case 5:(0,r.zU)(a),o.label=6;case 6:return[2]}}))}))}function it(t){t.preventDefault(),t.stopPropagation();var e=k();if(e){var n=e.actions,a=e.form,r=e.output;r.setAttribute("hidden",""),r.innerHTML="",b&&(b=void 0),a.removeAttribute("hidden"),n.setAttribute("hidden","")}}function ot(t){t.preventDefault(),t.stopPropagation();var e=z();if(e){var n=e.actions,a=e.form,r=e.output,i=e.time;r.setAttribute("hidden",""),r.innerHTML="",b&&(b=void 0),h&&(h.ondataavailable=null,h.stop(),h=void 0),f.length&&(f=[]),i.innerText="0:00",a.removeAttribute("hidden"),n.setAttribute("hidden","")}}function ct(t){t.preventDefault(),t.stopPropagation();var e=I();if(e){var n=e.actions,a=e.form,r=e.output,i=e.time;r.setAttribute("hidden",""),r.innerHTML="",b&&(b=void 0),h&&(h.ondataavailable=null,h.stop(),h=void 0),f.length&&(f=[]),i.innerText="0:00",a.removeAttribute("hidden"),n.setAttribute("hidden","")}}window.closeRecordImageDialog=$,window.closeRecordAudioDialog=tt,window.closeRecordVideoDialog=et;var dt=new Set(["image","audio","video"]);function st(t){var e=this.getAttribute("data-delete"),n=this.getAttribute("data-type");if(e&&dt.has(n)){var a=parseInt(e),r=this.closest("div.dialog-wrapper"),i=this.closest("div"),o=this.closest("output");if(i&&o&&!isNaN(a)&&r)if(i.remove(),Array.isArray(b))if(1===b.length)b=void 0;else{b=0===a?b.slice(1):a===b.length-1?b.slice(0,b.length-1):b.slice(0,a).concat(b.slice(a+1,b.length));var c=o.children[1];c&&"DIV"===c.nodeName&&c.style.setProperty("border-top","none")}else b=void 0}}function ut(t,e){var n=document.createElement("button");return n.setAttribute("type","button"),n.classList.add("icon-text","medium","filled","error"),n.insertAdjacentHTML("afterbegin",'<svg focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="Delete"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path></svg>'),n.append(new Text("DELETE")),n.setAttribute("data-delete",String(t)),n.setAttribute("data-type",e),n.style.setProperty("margin","4px 0px"),n.style.setProperty("margin-left","auto"),n.addEventListener("click",st),n}function lt(t){var e=document.createElement("div"),n=document.createElement("button");return n.setAttribute("type","button"),n.classList.add("icon-text","medium","filled","warning"),n.insertAdjacentHTML("afterbegin",'<svg focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="Edit"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path></svg>'),n.append(new Text("BACK TO FORM")),n.addEventListener("click",function(t){return function(){if("image"===t){var e=k();if(e){var n=e.output,a=e.form,r=e.actions;n.setAttribute("hidden",""),n.innerHTML="",b?r.removeAttribute("hidden"):r.setAttribute("hidden",""),a.removeAttribute("hidden")}}else if("audio"===t){var i=z();if(i){n=i.output,a=i.form,r=i.actions;var o=i.time;n.setAttribute("hidden",""),n.innerHTML="",o.innerText="0:00",b?r.removeAttribute("hidden"):r.setAttribute("hidden",""),a.removeAttribute("hidden")}}else if("video"===t){var c=I();c&&(n=c.output,a=c.form,r=c.actions,o=c.time,n.setAttribute("hidden",""),n.innerHTML="",o.innerText="0:00",b?r.removeAttribute("hidden"):r.setAttribute("hidden",""),a.removeAttribute("hidden"))}}}(t)),e.append(n),e}function pt(t,e,n){var a=document.createElement("div"),i=document.createElement("div");(0,r.CN)()||(i.style.cssText="max-width: 600px; max-height: 600px; display:block; margin: auto"),a.classList.add("text-align-right"),0!==n&&a.style.setProperty("border-top","2px solid var(--divider)"),a.style.setProperty("margin-bottom","0.75rem");var o=ut(n,"image"),c=function(t){var e=new Image;return e.style.setProperty("max-width","min(600px, 100%)"),e.style.setProperty("max-height","min(600px, 100%)"),e.style.setProperty("width","auto"),e.style.setProperty("height","auto"),e.classList.add("no-click"),e.src=URL.createObjectURL(t),e}(e);i.append(o,c),a.append(i),t.append(a)}function vt(t){if(b){var e=k();if(e){var n=e.output,a=e.form;if(n.innerHTML="",n.append(lt("image")),Array.isArray(b))for(var r=0;r<b.length;r++)pt(n,b[r],r);else pt(n,b,0);document.dispatchEvent(new CustomEvent("NEW_CONTENT_LOADED")),a.setAttribute("hidden",""),n.removeAttribute("hidden")}}}function mt(t,e,n){var a=document.createElement("div"),i=document.createElement("div");i.classList.add("text-align-right"),(0,r.CN)()||(i.style.cssText="max-width: 600px; max-height: 600px; display:block; margin: auto"),a.classList.add("flex-row","justify-center"),0!==n&&a.style.setProperty("border-top","2px solid var(--divider)"),a.style.setProperty("margin-bottom","0.75rem"),a.style.setProperty("margin-top","0.25rem");var o=ut(n,"image"),c=function(t){return ee(URL.createObjectURL(t),!0)}(e);i.append(o),i.insertAdjacentHTML("beforeend",c),a.append(i),t.append(a)}function ht(t){if(b){var e=I();if(e){var n=e.output,a=e.form;if(n.innerHTML="",n.append(lt("video")),Array.isArray(b))for(var r=0;r<b.length;r++)mt(n,b[r],r);else mt(n,b,0);document.dispatchEvent(new CustomEvent("NEW_CONTENT_LOADED")),a.setAttribute("hidden",""),n.removeAttribute("hidden")}}}function ft(t,e,n){var a=document.createElement("div"),i=document.createElement("div");i.classList.add("text-align-right"),(0,r.CN)()||(i.style.cssText="max-width: 600px; max-height: 600px; display:block; margin: auto"),a.classList.add("block"),0!==n&&a.style.setProperty("border-top","2px solid var(--divider)"),a.style.setProperty("margin-bottom","0.75rem"),a.style.setProperty("margin-top","0.25rem");var o=ut(n,"audio"),c=function(t){return te(URL.createObjectURL(t),!0)}(e);i.append(o),i.insertAdjacentHTML("beforeend",c),a.append(i),t.append(a)}function bt(t){if(b){var e=z();if(e){var n=e.output,a=e.form;if(n.innerHTML="",n.append(lt("audio")),Array.isArray(b))for(var r=0;r<b.length;r++)ft(n,b[r],r);else ft(n,b,0);document.dispatchEvent(new CustomEvent("NEW_CONTENT_LOADED")),a.setAttribute("hidden",""),n.removeAttribute("hidden")}}}function gt(t){return function(t){if(v){var e=v.getVideoTracks()[0];if(e){var n=e.getSettings().facingMode;"user"===n?e.applyConstraints({facingMode:"environment"}).then((function(){})).catch((function(t){alert(String(t))})):"environment"===n&&e.applyConstraints({facingMode:"user"}).then((function(){})).catch((function(t){alert(String(t))}))}}}}function yt(t){f.push(t.data);var e=Math.floor(Date.now()/1e3)-x;if("audio"===w){var n=z();n&&(n.time.innerText=(0,r.WR)(e))}else if("video"===w){var a=I();a&&(a.time.innerText=(0,r.WR)(e))}}function At(t){if(this.classList.contains("recording")){if(this.classList.remove("recording"),h){h.stop();var e="audio_".concat(window.crypto.randomUUID()).concat(".mp3"),n=new File(structuredClone(f),e,{type:"audio/mp3"}),a=z();if(a){var r=a.multiple,i=a.actions,o=a.time;"true"===r.value?Array.isArray(b)?b.push(n):b=[n]:b=n,i.removeAttribute("hidden"),o.innerText="0:00"}f=[],h.ondataavailable=null,h=void 0}}else if(this.classList.add("recording"),v){w="audio";var c=Math.floor(Date.now()/1e3);x=c;var d=new MediaRecorder(v);f=[],d.ondataavailable=yt,(h=d).start(1e3)}this.blur()}function wt(t){if(this.classList.contains("recording")){if(this.classList.remove("recording"),h){h.stop();var e="video_".concat(window.crypto.randomUUID()).concat(".mp4"),n=new File(structuredClone(f),e,{type:"video/mp4"}),a=I();if(a){var r=a.multiple,i=a.actions,o=a.time;"true"===r.value?Array.isArray(b)?b.push(n):b=[n]:b=n,i.removeAttribute("hidden"),o.innerText="0:00",f=[],h.ondataavailable=null,h=void 0}}}else if(this.classList.add("recording"),v){w="video";var c=Math.floor(Date.now()/1e3);x=c;var d=new MediaRecorder(v);f=[],d.ondataavailable=yt,(h=d).start(1e3)}this.blur()}function xt(t){var e=k();if(e){var n=e.multiple,a=e.actions;"true"===n.value?Array.isArray(b)?b.push(t):b=[t]:"false"===n.value&&(b=t),a.removeAttribute("hidden")}}function Et(t){var e="image_".concat(window.crypto.randomUUID()).concat(".webp");if(m)try{m.takePhoto().then((function(t){xt(new File([t],e,{type:"image/webp"}))})).catch((function(t){console.error(t)}))}catch(t){console.error(t)}else if(v){var n=document.createElement("canvas"),a=document.getElementById("take-image-video");if(a){n.width=a.videoWidth,n.height=a.videoHeight;var r=n.getContext("2d");r&&(r.drawImage(a,0,0,a.videoWidth,a.videoHeight),n.toBlob((function(t){t&&xt(new File([t],e,{type:"image/webp"}))})))}}this.blur()}function St(t){t.detail.elt.hasAttribute("hx-push-url")&&t.detail.successful&&($(),et(),tt())}function Lt(){if("mediaDevices"in navigator&&"getUserMedia"in navigator.mediaDevices){document.addEventListener("htmx:afterRequest",St);var t=Array.from(document.querySelectorAll('input[type="file"][data-image-input]')),e=Array.from(document.querySelectorAll('input[type="file"][data-audio-input]')),n=Array.from(document.querySelectorAll('input[type="file"][data-video-input]'));t.forEach((function(t){t.addEventListener("click",F)})),e.forEach((function(t){t.addEventListener("click",K)})),n.forEach((function(t){t.addEventListener("click",W)}));var a=document.getElementById("show-picker-image"),r=document.getElementById("show-picker-audio"),i=document.getElementById("show-picker-video");a&&a.addEventListener("click",G,!0),r&&r.addEventListener("click",J,!0),i&&i.addEventListener("click",X,!0);var o=document.getElementById("open-image-dialog"),c=document.getElementById("open-audio-dialog"),d=document.getElementById("open-video-dialog");o&&o.addEventListener("click",Q,!0),c&&c.addEventListener("click",Y,!0),d&&d.addEventListener("click",Z,!0);var s=k(),u=I(),l=z();if(s){var p=s.preview,v=s.takeImage,m=s.form,h=s.switchCameraButton;m.addEventListener("submit",nt),m.addEventListener("reset",it),p.addEventListener("click",vt),v.addEventListener("click",Et),h.addEventListener("click",gt())}if(l){p=l.preview;var f=l.recordAudio;(m=l.form).addEventListener("submit",at),m.addEventListener("reset",ot),p.addEventListener("click",bt),f.addEventListener("click",At)}if(u){p=u.preview;var b=u.recordVideo;m=u.form,h=u.switchCameraButton,m.addEventListener("submit",rt),m.addEventListener("reset",ct),p.addEventListener("click",ht),b.addEventListener("click",wt),h.addEventListener("click",gt())}}}var Ut=function(t,e,n,a){return new(n||(n=Promise))((function(r,i){function o(t){try{d(a.next(t))}catch(t){i(t)}}function c(t){try{d(a.throw(t))}catch(t){i(t)}}function d(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,c)}d((a=a.apply(t,e||[])).next())}))},Tt=function(t,e){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(d){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(o=0)),o;)try{if(n=1,a&&(r=2&c[0]?a.return:c[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,c[1])).done)return r;switch(a=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,a=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){o.label=c[1];break}if(6===c[0]&&o.label<r[1]){o.label=r[1],r=c;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(c);break}r[2]&&o.ops.pop(),o.trys.pop();continue}c=e.call(t,o)}catch(t){c=[6,t],a=0}finally{n=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,d])}}},Mt=(0,r.CN)(),kt={behavior:"smooth",block:"start",inline:"center"},zt={images:{},multipleImages:{}},It=new Set(["jpeg","jpg","png","webp","avif","tiff","svg"]),Ht=5e6,qt=54e7,Ct=54e7,Vt=6e6,Nt=new Set(["m4a","flac","mp3","mp4","wav","wma","aac","webm","mpeg","mov","ogg"]),Bt=new Set(["mp4","mov","avi","wmv","avchd","webm","flv"]),Pt=[{audioCodec:"aac",extension:"mp4",type:"audio/mp4"},{audioCodec:"flac",extension:"flac",type:"audio/flac"},{audioCodec:"opus",extension:"webm",type:"audio/webm"}],Dt=[{videoCodec:"libvpx",extension:"webm",type:"video/webm"},{videoCodec:"libx264",extension:"mp4",type:"video/mp4"}];function jt(t,e){return new CustomEvent("media-upload-complete",{detail:{uploads:e}})}var _t=function(t){var e=t.lastIndexOf(".");return t.slice(e+1)};function Ot(t){var e,n;if(t&&0!==t.width&&0!==t.height){var a=t.width/t.height;return t.height>400?e=(n=400)*a:(n=t.height,e=t.width),{width:e,height:n}}return null}function Rt(t){return Ut(this,void 0,void 0,(function(){return Tt(this,(function(e){return[2,new Promise((function(e,n){var a=void 0,r=URL.createObjectURL(t),i=document.createElement("video");i.onloadedmetadata=function(t){a&&clearTimeout(a),URL.revokeObjectURL(r),0!==i.videoWidth&&0!==i.videoHeight||e(null),e({width:i.videoWidth,height:i.videoHeight})},i.src=r,i.load(),a=setTimeout((function(){e(null)}),2e3)}))]}))}))}function Ft(t){return Ut(this,void 0,void 0,(function(){return Tt(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,Rt(t)];case 1:return[2,Ot(e.sent())];case 2:return e.sent(),[2,null];case 3:return[2]}}))}))}function Kt(t){return Ut(this,void 0,void 0,(function(){return Tt(this,(function(e){return[2,new Promise((function(e,n){var a=void 0,r=URL.createObjectURL(t),i=document.createElement("img");i.onload=function(t){a&&clearTimeout(a),URL.revokeObjectURL(r),0!==i.naturalWidth&&0!==i.naturalHeight||e(null),e({width:i.naturalWidth,height:i.naturalHeight})},i.src=r,a=setTimeout((function(){e(null)}),2e3)}))]}))}))}function Wt(t){return Ut(this,void 0,void 0,(function(){var e;return Tt(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Kt(t)];case 1:return(e=n.sent())?[2,e]:[2,{width:null,height:null}];case 2:return n.sent(),[2,{width:null,height:null}];case 3:return[2]}}))}))}function Gt(t,e,n){for(var a=0,i=Array.isArray(n)?n:[n];a<i.length;a++){var o=i[a],c=document.createElement("span");c.innerText=o.filename,c.classList.add("body2");var d="cop_url_".concat(window.crypto.randomUUID()),s=document.createElement("button");s.className="icon button small",s.setAttribute("type","button"),s.setAttribute("aria-label","Copy URL"),s.setAttribute("data-copy-input",""),s.setAttribute("data-input",d),s.setAttribute("data-snackbar",""),s.setAttribute("data-selem","#copy-url-input"),s.insertAdjacentHTML("afterbegin",'<svg focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="CopyAll"><path d="M18 2H9c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H9V4h9v12zM3 15v-2h2v2H3zm0-5.5h2v2H3v-2zM10 20h2v2h-2v-2zm-7-1.5v-2h2v2H3zM5 22c-1.1 0-2-.9-2-2h2v2zm3.5 0h-2v-2h2v2zm5 0v-2h2c0 1.1-.9 2-2 2zM5 6v2H3c0-1.1.9-2 2-2z"></path></svg>');var u=document.createElement("input");u.setAttribute("type","text"),u.setAttribute("name",d),u.setAttribute("hidden",""),u.setAttribute("readonly",""),u.setAttribute("value",o.filename);var l=document.createElement("p");l.classList.add("mt-2"),l.innerText=o.originalFilename;var p=document.createElement("span");p.innerText="Original Filename: ",p.classList.add("bold"),l.insertAdjacentElement("afterbegin",p),t.insertAdjacentHTML("beforeend","\n".concat(l.outerHTML,'\n<div class="flex-row justify-begin mt-1">\n  <span class="bg-card w-auto p-md flex-row gap-3 align-center no-wrap" style="border-radius: 0.5rem; border: 2px solid var(--text-primary);">\n    ').concat(c.outerHTML,"\n    ").concat(s.outerHTML,"\n  </span>\n    ").concat(u.outerHTML,"\n</div>\n    "))}(0,r.KT)(t)}function Jt(t,e,n){for(var a=0,i=Array.isArray(n)?n:[n];a<i.length;a++){var o=i[a],c=document.createElement("span");c.innerText=o,c.classList.add("body2");var d="cop_url_".concat(window.crypto.randomUUID()),s=document.createElement("button");s.className="icon button small",s.setAttribute("type","button"),s.setAttribute("aria-label","Copy URL"),s.setAttribute("data-copy-input",""),s.setAttribute("data-input",d),s.setAttribute("data-snackbar",""),s.setAttribute("data-selem","#copy-url-input"),s.insertAdjacentHTML("afterbegin",'<svg focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="CopyAll"><path d="M18 2H9c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h9c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H9V4h9v12zM3 15v-2h2v2H3zm0-5.5h2v2H3v-2zM10 20h2v2h-2v-2zm-7-1.5v-2h2v2H3zM5 22c-1.1 0-2-.9-2-2h2v2zm3.5 0h-2v-2h2v2zm5 0v-2h2c0 1.1-.9 2-2 2zM5 6v2H3c0-1.1.9-2 2-2z"></path></svg>');var u=document.createElement("input");u.setAttribute("type","text"),u.setAttribute("name",d),u.setAttribute("hidden",""),u.setAttribute("readonly",""),u.setAttribute("value",o),t.insertAdjacentHTML("beforeend",'\n<div class="mt-3 flex-row justify-begin">\n  <span class="bg-card w-auto p-md flex-row gap-3 align-center no-wrap" style="border-radius: 0.5rem; border: 2px solid var(--text-primary);">\n    '.concat(c.outerHTML,"\n    ").concat(s.outerHTML,"\n  </span>\n    ").concat(u.outerHTML,"\n</div>\n    "))}(0,r.KT)(t)}function Xt(t){for(var e=[],n=t.replace("https://audio.storething.org/frankmbrown/",""),a=n.slice(0,n.lastIndexOf(".")),r=n.slice(n.lastIndexOf(".")+1),i=0,o=Pt;i<o.length;i++){var c=o[i];e.push({src:"https://audio.storething.org/frankmbrown/".concat(a,".").concat(c.audioCodec,".").concat(c.extension),type:c.type})}return e.push({src:t,type:"audio/".concat(r)}),{audioSources:e,name:a,key:n}}function Qt(t){for(var e=[],n=t.replace("https://video.storething.org/frankmbrown/",""),a=n.slice(0,n.lastIndexOf(".")),r=n.slice(n.lastIndexOf(".")+1),i=0,o=Dt;i<o.length;i++){var c=o[i];e.push({src:"https://video.storething.org/frankmbrown/".concat(a,".").concat(c.videoCodec,".").concat(c.extension),type:c.type})}return e.push({src:t,type:"video/".concat(r)}),{videoSources:e,name:a,key:n}}function Yt(t){var e=document.getElementById("loading-dialog");e&&(0,r.pX)(e,t)}function Zt(){var t=document.getElementById("loading-dialog");t&&!t.hasAttribute("hidden")&&(0,r.zU)(t)}function $t(t,e,n){var a=document.createElement("details");a.setAttribute("data-photo-text",""),a.style.cssText="border:1px solid var(--divider);",a.setAttribute("data-index",String(e)),a.setAttribute("aria-label","Image Associated Text"),n&&a.setAttribute("hidden","");var r=document.createElement("label");r.setAttribute("for",String(t).concat("-short-description")),r.className="caption bold",r.innerText="Short Image Description:";var i=document.createElement("input");i.setAttribute("type","text"),i.setAttribute("autocomplete","off"),i.setAttribute("name","".concat(String(t),"-short-description")),i.setAttribute("id","".concat(String(t),"-short-description")),i.className="medium icon-before mt-1",i.setAttribute("placeholder","Enter a short description of the image..."),i.setAttribute("maxlength","50"),i.setAttribute("spellcheck","false"),i.setAttribute("autocapitalize","off");var o=document.createElement("label");o.className="caption bold",o.setAttribute("for",String(t).concat("-long-description")),o.innerText="Longer Image Description:";var c=document.createElement("textarea");c.setAttribute("name","".concat(String(t),"-long-description")),c.setAttribute("id","".concat(String(t),"-long-description")),c.setAttribute("placeholder","Enter a long description of the image ..."),c.setAttribute("rows","5"),c.setAttribute("maxlength","200"),c.setAttribute("spellcheck","false"),c.setAttribute("autocomplete","off"),c.setAttribute("autocapitalize","off");var d='\n    <summary>\n        <span class="h6 fw-regular">Image Associated Text</span>\n        <svg class="details" focusable="false" inert viewBox="0 0 24 24">\n          <path d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z">\n          </path>\n        </svg>\n    </summary>\n    <div class="accordion-content" aria-hidden="true">\n      <div class="input-group block" data-hover="false" data-focus="false" data-error="false" data-blurred="false">\n        '.concat(r.outerHTML,'\n        <div class="text-input block medium">\n            ').concat(i.outerHTML,'\n            <svg class="icon-before"  focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="Title"><path d="M5 4v3h5.5v12h3V7H19V4z"></path></svg>\n        </div>\n      </div>\n      <div class="input-group block mt-1" data-hover="false" data-focus="false" data-error="false" data-blurred="false"> \n        ').concat(o.outerHTML,'\n        <div class="mt-1 text-input block medium disabled">\n            ').concat(c.outerHTML,"\n        </div>\n      </div>\n    </div>");return a.insertAdjacentHTML("afterbegin",d),a}function te(t,e){var n,a=!Mt,i="iN_"+window.crypto.randomUUID(),o="audio-input-src-".concat(i),c="audio-input-title-".concat(i),d="audio_rand_id_".concat(window.crypto.randomUUID()),s="audio_rand_id_".concat(window.crypto.randomUUID()),u="audio_rand_id_".concat(window.crypto.randomUUID()),l="audio_rand_id_".concat(window.crypto.randomUUID()),p="audio_rand_id_".concat(window.crypto.randomUUID()),v="audio_rand_id_".concat(window.crypto.randomUUID()),m="audio_rand_id_".concat(window.crypto.randomUUID());e?"boolean"==typeof e?((n=document.createElement("p")).classList.add("body1","bold"),n.innerText="Placeholder Audio Title"):"string"==typeof e?((n=document.createElement("p")).classList.add("body1","bold"),n.innerText=e):n=document.createElement("p"):((n=document.createElement("input")).setAttribute("type","text"),n.setAttribute("hidden",""),n.setAttribute("name",o),n.setAttribute("id",o),n.setAttribute("value",String(t)));var h=document.createElement("audio");if(h.setAttribute("controls",""),h.setAttribute("hidden",""),h.setAttribute("data-resume","false"),h.setAttribute("data-play-through","true"),h.setAttribute("data-src",t),h.setAttribute("preload","metadata"),"boolean"==typeof e&&!0===e)(x=document.createElement("source")).setAttribute("src",t),h.append(x);else{var f=Xt(t),b=f.audioSources,g=(f.key,f.name),y=document.createElement("track");y.setAttribute("default",""),y.setAttribute("kind","captions"),y.setAttribute("src","/vtt/audio/".concat(g)),y.setAttribute("srclang","en"),h.append(y);for(var A=0,w=b;A<w.length;A++){var x=w[A],E=document.createElement("source");E.setAttribute("src",x.src),E.setAttribute("type",x.type),h.append(E)}}var S=Boolean(!(0,r.CN)());return'\n  <div class="audio mt-3" data-audio-wrapper style="margin: 10px 0px;">\n    '.concat(h.outerHTML,'\n    <div class="audio-header align-center gap-2" style="margin-bottom: 4px;">\n      ').concat(n.outerHTML,"\n      ").concat(Boolean(e)?"":'\n      <div class="input-group grow-1" data-hover="false" data-focus="false" data-error="false" data-blurred="false">\n        <label for="'.concat(c,'" class="caption bold">Audio Title*:</label>\n        <div class="text-input block medium">\n            <input \n            type="text" \n            autocomplete="off" \n            name="').concat(c,'" \n            id="').concat(c,'" \n            class="medium icon-before mt-1" \n            required\n            placeholder="Enter the Audio Title..." \n            maxlength="50"\n            minlength="1" \n            spellcheck="false" \n            autocapitalize="off"\n            >\n            <svg class="icon-before"  focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="Title"><path d="M5 4v3h5.5v12h3V7H19V4z"></path></svg>\n        </div>\n      </div>\n      '),'\n      <div class="audio-time-left">\n        <span data-ellapsed="">0:00</span>\n        /\n        <span data-remaining="">0:00</span>\n      </div>\n    </div>\n    <p data-error-text class="caption w-100 t-error" hidden>There was an error loading this audio file. Try reloading the page.</p>\n    <p data-warn-text class="caption w-100 t-warning" hidden>There was an error loading the rest of the audio file. Try reloading the page.</p>\n    <div class="flex-row justify-start align-center">\n      <div class="flex-row align-center justify-center grow-0" data-main-controls>\n        <button data-play data-type="audio" aria-hidden="true" class="icon large" type="button" aria-label="Play Audio">\n          <svg focusable="false" inert viewBox="0 0 24 24"><path d="M8 5v14l11-7L8 5z"></path></svg>\n        </button>\n        <button data-pause data-type="audio" hidden aria-hidden="true" class="icon large" type="button" aria-label="Pause Audio">\n          <svg focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="Pause"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path></svg>                  \n        </button>\n        <button data-replay data-type="audio" hidden aria-hidden="true" class="icon large" type="button" aria-label="Replay Audio">\n          <svg focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="Replay"><path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"></path></svg>                  \n        </button>\n        <div data-load data-type="audio" hidden class="t-tsecondary">\n          <div class="lds-ring"><div></div><div></div><div></div><div></div></div>\n        </div>\n        <svg data-error hidden class="h6 t-error p-md" focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="Report">\n          <path d="M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27L15.73 3zM12 17.3c-.72 0-1.3-.58-1.3-1.3 0-.72.58-1.3 1.3-1.3.72 0 1.3.58 1.3 1.3 0 .72-.58 1.3-1.3 1.3zm1-4.3h-2V7h2v6z">\n          </path>\n        </svg>\n      </div>\n      <input data-time data-type="audio" id="').concat(d,'" name="').concat(d,'" type="range" value="0" min="0" max="29" data-time-set="true" step="1" style="background-size: 0% 100%;">\n      <output hidden for="').concat(d,'">0</output>\n    </div>\n    <div class="flex-row align-center justify-start gap-2" style="max-width: 100%;">\n      <div ').concat(S?'data-popover data-mouse data-pelem="#'.concat(s,'" aria-describedby="').concat(s,'"'):"",'>\n        <button data-mute-button data-type="audio" class="icon medium" aria-label="Mute / Unmute Audio" title="Mute / Unmute Audio" type="button">\n          <svg data-type="sound-up" focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="VolumeUp"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"></path></svg>\n          <svg hidden data-type="sound-down" focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="VolumeDown"><path d="M18.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM5 9v6h4l5 5V4L9 9H5z"></path></svg>\n          <svg hidden data-type="muted" focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="VolumeOff"><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3 3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4 9.91 6.09 12 8.18V4z"></path></svg>\n        </button>\n      </div>\n      ').concat(a?'\n      <input data-sound data-type="audio" type="range" value="100" min="0" max="100" class="small primary" id="'.concat(l,'" name="').concat(l,'" style="background-size: 100% 100%;">\n      <output hidden for="').concat(l,'">100</output>\n      '):'<div class="grow-1"></div>','\n\n      <button data-closed-captions type="button" class="icon medium" aria-label="Closed Captioning" ').concat(S?'data-popover data-pelem="#'.concat(m,'" data-mouse'):"",'>\n        <svg data-on hidden focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="ClosedCaption"><path d="M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 7H9.5v-.5h-2v3h2V13H11v1c0 .55-.45 1-1 1H7c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1zm7 0h-1.5v-.5h-2v3h2V13H18v1c0 .55-.45 1-1 1h-3c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1z"></path></svg>\n        <svg data-off focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="ClosedCaptionOff"><path d="M19.5 5.5v13h-15v-13h15zM19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 7H9.5v-.5h-2v3h2V13H11v1c0 .55-.45 1-1 1H7c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1zm7 0h-1.5v-.5h-2v3h2V13H18v1c0 .55-.45 1-1 1h-3c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1z"></path></svg>\n      </button>\n      <div ').concat(S?'data-popover data-mouse data-pelem="#'.concat(u,'" aria-describedby="').concat(u,'"'):"",'>\n        <div class="select" aria-label="Sound Playback Speed Select">\n          <button  ').concat(Boolean(a)?"":"data-force-close",' class="icon medium select auto-w" aria-label="Playback Speed" title="Playback Speed" data-popover data-click data-pelem="#').concat(p,'" aria-controls="').concat(p,'" aria-haspopup="listbox" aria-expanded="false" role="combobox" type="button">\n            <svg focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="Speed"><path d="m20.38 8.57-1.23 1.85a8 8 0 0 1-.22 7.58H5.07A8 8 0 0 1 15.58 6.85l1.85-1.23A10 10 0 0 0 3.35 19a2 2 0 0 0 1.72 1h13.85a2 2 0 0 0 1.74-1 10 10 0 0 0-.27-10.44zm-9.79 6.84a2 2 0 0 0 2.83 0l5.66-8.49-8.49 5.66a2 2 0 0 0 0 2.83z"></path></svg>\n          </button>\n          <div ').concat(Boolean(a)?"":"data-click-capture",' tabindex="0" id="').concat(p,'" role="listbox" class="select-menu o-sm" style="width: 50px;" data-placement="bottom">\n            <input data-playback data-type="audio" type="text" hidden value="1" name="').concat(v,'" id="').concat(v,'">\n            <button tabindex="-1" class="select-option body2" role="option" aria-selected="false" data-val="0.25" type="button">\n              0.25\n            </button>\n            <button tabindex="-1" class="select-option body2" role="option" aria-selected="false" data-val="0.5" type="button">\n              0.5\n            </button>\n            <button tabindex="-1" class="select-option body2" role="option" aria-selected="false" data-val="0.75" type="button">\n              0.75\n            </button>\n            <button tabindex="-1" class="select-option body2" role="option" aria-selected="true" data-val="1" type="button">\n              1\n            </button>\n            <button tabindex="-1" class="select-option body2" role="option" aria-selected="false" data-val="1.25" type="button">\n              1.25\n            </button>\n            <button tabindex="-1" class="select-option body2" role="option" aria-selected="false" data-val="1.5" type="button">\n              1.5\n            </button>\n            <button tabindex="-1" class="select-option body2" role="option" aria-selected="false" data-val="1.75" type="button">\n              1.75\n            </button>\n            <button tabindex="-1" class="select-option body2" role="option" aria-selected="false" data-val="2" type="button">\n              2\n            </button>\n          </div>\n  \n        </div>\n      </div>\n      ').concat(S?'\n      <div data-placement="left-start" class="tooltip caption" id="'.concat(u,'" role="tooltip"> \n        Playback Speed\n      </div>\n      <div data-placement="top" class="tooltip caption" id="').concat(s,'" role="tooltip">\n        Mute / Unmute Audio\n      </div>\n      <div data-placement="top" class="tooltip caption" id="').concat(m,'" role="tooltip">\n        Closed Captioning\n      </div>\n      '):"","\n    </div>\n  </div>")}function ee(t,e,n){var a=!Mt,i="iN_"+window.crypto.randomUUID(),o="video-input-src-".concat(i),c="video-input-title-".concat(i),d="video-input-description-".concat(i),s="video_rand_id_".concat(window.crypto.randomUUID()),u="video_rand_id_".concat(window.crypto.randomUUID()),l="video_rand_id_".concat(window.crypto.randomUUID()),p="video_rand_id_".concat(window.crypto.randomUUID()),v="video_rand_id_".concat(window.crypto.randomUUID()),m="video_rand_id_".concat(window.crypto.randomUUID()),h="video_rand_id_".concat(window.crypto.randomUUID()),f=document.createElement("video");if(f.setAttribute("data-play-through","true"),f.setAttribute("playsinline",""),f.setAttribute("webkit-playsinline",""),f.setAttribute("data-src",t),f.setAttribute("preload","metadata"),n&&(f.setAttribute("height",String(n)),f.setAttribute("data-height",String(n))),"boolean"==typeof e&&!0===e)(E=document.createElement("source")).setAttribute("src",t),f.append(E);else{var b=Qt(t),g=b.videoSources,y=(b.key,b.name);f.setAttribute("poster","https://image.storething.org/frankmbrown/".concat(y,"-thumbnail.png"));var A=document.createElement("track");A.setAttribute("default",""),A.setAttribute("kind","captions"),A.setAttribute("src","/vtt/video/".concat(y)),A.setAttribute("srclang","en"),f.append(A);for(var w=0,x=g;w<x.length;w++){var E=x[w],S=document.createElement("source");S.setAttribute("src",E.src),S.setAttribute("type",E.type),f.append(S)}}var L=document.createElement("input");L.setAttribute("value",t),L.setAttribute("hidden",""),L.setAttribute("type","text"),L.setAttribute("id",o),L.setAttribute("name",o);var U="";if("boolean"!=typeof e&&void 0!==e){var T=document.createElement("div");T.className="video-info";var M=document.createElement("p");M.className="h4 bold",M.innerText=e.title;var k=document.createElement("p");k.className="body1",k.innerText=e.description,T.append(M,k),U=T.outerHTML}var z=Boolean(!(0,r.CN)());return'<div class="video-wrapper" data-video-wrapper style="margin: 10px 0px;">\n  <div class="video" data-fullscreen="false" data-focus="false" data-hover="false">\n    '.concat(f.outerHTML,'\n    <div class="video-controls">\n      <div class="block">\n        <input data-time data-type="video" type="range" id="').concat(s,'" name="').concat(s,'" class="video small primary" min="0" value="0" max="422" data-time-set="true" step="1" style="background-size: 0% 100%;">\n      </div>\n      <div class="flex-row justify-begin align-center gap-2 p-sm" style="padding-top:0px;" data-row-2>\n        <div class="flex-row align-center justify-center grow-0" data-main-controls>\n          <button data-play data-type="video" aria-hidden="true" class="icon large" type="button" aria-label="Play Audio">\n            <svg focusable="false" inert viewBox="0 0 24 24"><path d="M8 5v14l11-7L8 5z"></path></svg>\n          </button>\n          <button data-pause data-type="video" hidden aria-hidden="true" class="icon large" type="button" aria-label="Pause Audio">\n            <svg focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="Pause"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path></svg>                  \n          </button>\n          <button data-replay data-type="video" hidden aria-hidden="true" class="icon large" type="button" aria-label="Replay Audio">\n            <svg focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="Replay"><path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"></path></svg>                  \n          </button>\n          <div data-load data-type="video" hidden class="t-tsecondary">\n            <div class="lds-ring"><div></div><div></div><div></div><div></div></div>\n          </div>\n          <svg data-error data-type="video" hidden class="h6 t-error p-md" focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="Report"><path d="M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27L15.73 3zM12 17.3c-.72 0-1.3-.58-1.3-1.3 0-.72.58-1.3 1.3-1.3.72 0 1.3.58 1.3 1.3 0 .72-.58 1.3-1.3 1.3zm1-4.3h-2V7h2v6z"></path></svg>\n        </div>\n        <div ').concat(z?'data-popover data-mouse data-pelem="#'.concat(u,'" aria-describedby="').concat(u,'"'):"",'>\n          <button data-mute-button data-type="video" class="icon medium" aria-label="Mute / Unmute Audio" title="Mute / Unmute Audio" type="button">\n            <svg data-type="sound-up" focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="VolumeUp"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"></path></svg>\n            <svg hidden data-type="sound-down" focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="VolumeDown"><path d="M18.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM5 9v6h4l5 5V4L9 9H5z"></path></svg>\n            <svg hidden data-type="muted" focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="VolumeOff"><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3 3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4 9.91 6.09 12 8.18V4z"></path></svg>\n          </button>\n        </div>\n        ').concat(z?'\n        <input class="small secondary" data-sound data-type="video" id="'.concat(l,'" name="').concat(l,'" type="range" value="100" min="0" max="100" step="1" style="background-size: 100% 100%;">\n        <output for="').concat(l,'" hidden>100</output>\n        '):'<div class="grow-1"></div>','\n        <div class="video-time-left">\n          <span data-ellapsed>0:00</span>\n          /\n          <span data-remaining>0:00</span>\n        </div>\n        <button data-closed-captions type="button" class="icon medium" aria-label="Closed Captioning" ').concat(z?'data-popover data-pelem="#'.concat(h,'" data-mouse'):"",'>\n          <svg data-on hidden focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="ClosedCaption"><path d="M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 7H9.5v-.5h-2v3h2V13H11v1c0 .55-.45 1-1 1H7c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1zm7 0h-1.5v-.5h-2v3h2V13H18v1c0 .55-.45 1-1 1h-3c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1z"></path></svg>\n          <svg data-off focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="ClosedCaptionOff"><path d="M19.5 5.5v13h-15v-13h15zM19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 7H9.5v-.5h-2v3h2V13H11v1c0 .55-.45 1-1 1H7c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1zm7 0h-1.5v-.5h-2v3h2V13H18v1c0 .55-.45 1-1 1h-3c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1z"></path></svg>\n        </button>\n        <div ').concat(z?'data-popover data-mouse data-pelem="#'.concat(m,'" aria-describedby="').concat(m,'"'):"",'>\n          <div class="select" aria-label="Sound Playback Speed Select">\n            <button ').concat(Boolean(a)?"":"data-force-close",' class="icon medium select auto-w" aria-label="Playback Speed" title="Playback Speed" data-popover data-click data-pelem="#').concat(p,'" aria-controls="').concat(p,'" aria-haspopup="listbox" aria-expanded="false" role="combobox" type="button">\n              <svg focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="Speed"><path d="m20.38 8.57-1.23 1.85a8 8 0 0 1-.22 7.58H5.07A8 8 0 0 1 15.58 6.85l1.85-1.23A10 10 0 0 0 3.35 19a2 2 0 0 0 1.72 1h13.85a2 2 0 0 0 1.74-1 10 10 0 0 0-.27-10.44zm-9.79 6.84a2 2 0 0 0 2.83 0l5.66-8.49-8.49 5.66a2 2 0 0 0 0 2.83z"></path></svg>\n            </button>\n            <div ').concat(Boolean(a)?"":"data-click-capture",' tabindex="0" id="').concat(p,'" role="listbox" class="select-menu o-sm" style="width: 50px;" data-placement="top">\n              <input data-playback data-type="video" type="text" hidden value="1" name="').concat(v,'" id="').concat(v,'">\n              <button tabindex="-1" class="select-option body2" role="option" aria-selected="false" data-val="0.25" type="button">\n                0.25\n              </button>\n              <button tabindex="-1" class="select-option body2" role="option" aria-selected="false" data-val="0.5" type="button">\n                0.5\n              </button>\n              <button tabindex="-1" class="select-option body2" role="option" aria-selected="false" data-val="0.75" type="button">\n                0.75\n              </button>\n              <button tabindex="-1" class="select-option body2" role="option" aria-selected="true" data-val="1" type="button">\n                1\n              </button>\n              <button tabindex="-1" class="select-option body2" role="option" aria-selected="false" data-val="1.25" type="button">\n                1.25\n              </button>\n              <button tabindex="-1" class="select-option body2" role="option" aria-selected="false" data-val="1.5" type="button">\n                1.5\n              </button>\n              <button tabindex="-1" class="select-option body2" role="option" aria-selected="false" data-val="1.75" type="button">\n                1.75\n              </button>\n              <button tabindex="-1" class="select-option body2" role="option" aria-selected="false" data-val="2" type="button">\n                2\n              </button>\n            </div>\n            ').concat(z?'\n            <div data-placement="top" class="tooltip caption" id="'.concat(u,'" role="tooltip">\n              Mute / Unmute Audio\n            </div>\n            <div data-placement="left-start" class="tooltip caption" id="').concat(m,'" role="tooltip">\n              Playback Speed\n            </div>\n            <div data-placement="top" class="tooltip caption" id="').concat(h,'" role="tooltip">\n              Closed Captions\n            </div>\n            '):"",'\n          </div>\n        </div>\n        <button class="icon medium" data-fullscreen type="button">\n          <svg data-type="fullscreen" focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="FullscreenSharp"><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"></path></svg>\n          <svg data-type="no-fullscreen" hidden focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="FullscreenExit"><path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"></path></svg>\n        </button>\n      </div>\n    </div>\n  </div>\n  ').concat(e?U:'\n  <div class="video-info">\n    '.concat(L.outerHTML,'\n    <div class="input-group block" data-hover="false" data-focus="false" data-error="false" data-blurred="false">\n      <label for="').concat(c,'" class="caption bold">Video Title*:</label>\n      <div class="text-input block medium">\n          <input \n          type="text" \n          name="').concat(c,'" \n          id="').concat(c,'" \n          class="medium icon-before mt-1" \n          required\n          placeholder="Enter Video Title..." \n          maxlength="50"\n          minlength="1" \n          spellcheck="false" \n          autocapitalize="off"\n          autocomplete="off"\n          >\n          <svg class="icon-before"  focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="Title"><path d="M5 4v3h5.5v12h3V7H19V4z"></path></svg>\n          \x3c!-- Buttons and SVGs --\x3e\n      </div>\n    </div>\n    <div class="input-group block mt-1" data-hover="false" data-focus="false" data-error="false" data-blurred="false"> \n      <label for="').concat(d,'" class="caption bold">Video Description:</label>\n      <div class="mt-1 text-input block medium disabled">\n          <textarea \n          name="').concat(d,'" \n          id="').concat(d,'" \n          placeholder="Enter a description of the video..." \n          rows="5" \n          maxlength="200" \n          spellcheck="false"\n          autocomplete="off"\n          autocapitalize="off"\n          style=""\n          ></textarea>\n      </div>\n      <p class="char-counter" data-input="').concat(d,'">\n          <span class="max-counter body2" data-val="200" aria-hidden="false">Characters Remaining</span>\n      </p>\n    </div>\n  </div>\n  '),"\n</div>")}function ne(t,e,n){var a=(n||document).querySelector('audio[data-src="'.concat(t,'"]'));if(a){var r=a.closest("div.audio");if(r){var i=r.querySelector('input[type="text"][id^="audio-input-title-"]');i&&(i.value=e)}}}function ae(t,e,n,a){var r=(a||document).querySelector('video[data-src="'.concat(t,'"]'));if(r){var i=r.closest("div.video-wrapper");if(i){var o=i.querySelector('input[type="text"][id^="video-input-title-"]'),c=i.querySelector('textarea[id^="video-input-description-"]');o&&(o.value=e),c&&(c.value=n)}}}function re(t){var e=document.getElementById("image-error-popover");"false"!==(e?e.getAttribute("aria-hidden"):"true")&&e&&(Array.from(e.querySelectorAll("span[data-error]")).forEach((function(e){e.getAttribute("data-error")===String(t)?e.removeAttribute("hidden"):e.setAttribute("hidden","")})),(0,r.Gm)(e))}function ie(t){var e=t.name,n=t.file,a=t.initial,r=t.multiple,i=void 0!==r&&r,o=(t.original,t.previouslyUploaded),c=void 0!==o&&o;return Ut(this,void 0,void 0,(function(){var t,r,o,d,s,u,l,p,v;return Tt(this,(function(m){switch(m.label){case 0:if(m.trys.push([0,4,,5]),t=i?a?"Uploading Images...":"Updating Image in Database...":a?"Uploading Image...":"Updating Image in Database...",i||c||Yt(t),!(r=n.type).startsWith("image/",0))throw new Error("1");if(o=r.replace("image/",""),n.size>Ht)throw new Error("2");if(!It.has(o))throw new Error("3");return[4,Wt(n)];case 1:return d=m.sent(),[4,fetch("/api/signed-url/image/".concat(encodeURIComponent(e)).concat("?size=".concat(n.size,"&height=").concat(d.height,"&width=").concat(d.width))).then((function(t){if(200!==t.status)throw new Error("Network request");return t.json()})).then((function(t){return t.url})).catch((function(t){throw console.error(t),new Error("Unable to get Image signed URL.")}))];case 2:return s=m.sent(),[4,fetch(s,{method:"PUT",headers:{"Content-Type":"multipart/form-data"},body:n}).then((function(t){if(200!==t.status)throw new Error("Network request")})).catch((function(t){throw console.error(t),new Error("Unable to post image object to s3.")}))];case 3:return m.sent(),u=new URL(s),l="https://image.storething.org".concat(u.pathname),i||Zt(),[2,{imageUrl:l,type:o}];case 4:return p=m.sent(),console.error(p),i||Zt(),v=parseInt(p.message),!isNaN(v)&&v>=1&&v<4?re(v):re(4),[2,null];case 5:return[2]}}))}))}function oe(t,e,n,a,r){return Ut(this,void 0,void 0,(function(){var n,a,i,o,c,d,s,u,l,p,v,m,h,f,b,g,y;return Tt(this,(function(A){switch(A.label){case 0:return(n=document.querySelector('input[name="'.concat(r,'"]')))?n.hasAttribute("multiple")?(a=zt.multipleImages[r])?(i=a.input,(o=e.closest("output"))&&(c=o.querySelector('div[data-input-name="'.concat(r,'"]')))?(d=String(c.getAttribute("data-index")),s=parseInt(d),isNaN(s)||!isFinite(s)?[3,2]:(u=a.files[s])?[4,ie({name:u.name,initial:!1,file:t.dest,original:!1})]:[3,2]):[3,2]):[3,2]:[3,3]:[3,5];case 1:h=A.sent(),l=document.querySelector('label[for="'.concat(u.currentUrl,'-short-description"]')),p=document.querySelector('label[for="'.concat(u.currentUrl,'-long-description"]')),f=document.querySelector('input[id="'.concat(u.currentUrl,'-short-description"]')),b=document.querySelector('textarea[id="'.concat(u.currentUrl,'-long-description"]')),h&&l&&p&&f&&b&&(g=h.imageUrl,v=h.type,l&&l.setAttribute("for",g.concat("-short-description")),p&&p.setAttribute("for",g.concat("-long-description")),b&&(b.setAttribute("name",g.concat("-long-description")),b.setAttribute("id",g.concat("-long-description"))),f&&(f.setAttribute("name",g.concat("-short-description")),f.setAttribute("id",g.concat("-short-description"))),u.currentUrl=g,u.currentFile=t.dest,u.type=v,a.imageEditor&&(a.imageEditor.src=t.dest),i.value=a.files.map((function(t){return t.currentUrl.trim()})).join("|"),h&&n.dispatchEvent(jt(0,a.files.map((function(t){return t.currentUrl.trim()})).map((function(t){return{url:t}}))))),A.label=2;case 2:return[3,5];case 3:return(m=zt.images[r])?[4,ie({name:m.name,initial:!1,file:t.dest,original:!1})]:[3,5];case 4:h=A.sent(),f=document.querySelector('input[id="'.concat(r,'-short-description"]')),b=document.querySelector('textarea[id="'.concat(r,'-long-description"]')),h&&f&&b&&(g=h.imageUrl,b&&(b.value=""),f&&(f.value=""),m.currentUrl=g,(y=document.querySelector('input[name="'.concat(r,'-text"]')))&&(y.value=g),m.currentFile=t.dest,m.imageEditor&&(m.imageEditor.src=t.dest),h&&n.dispatchEvent(jt(0,[{url:h.imageUrl}]))),A.label=5;case 5:return[2]}}))}))}function ce(t,e,a,r,i){return void 0===i&&(i=!1),Ut(this,void 0,void 0,(function(){var a=this;return Tt(this,(function(o){return[2,new Promise((function(o,c){n.e(3648).then(n.bind(n,89026)).then((function(n){var c=(0,n.appendDefaultEditor)(t,{src:e,animations:"auto"});setTimeout((function(){i||t.scrollIntoView(kt)}),10),c.on("process",(function(e){return Ut(a,void 0,void 0,(function(){return Tt(this,(function(n){switch(n.label){case 0:return[4,oe(e,t,0,0,r)];case 1:return n.sent(),[2]}}))}))})),c.on("loaderror",(function(t){re(4)})),c.on("processerror",(function(t){re(4)})),o(c)})).catch((function(t){c("Something went wrong ")}))}))]}))}))}function de(t){var e=t.detail;if("next"===e){var n=String(this.getAttribute("data-index")),a=parseInt(n);if((l=String(this.getAttribute("data-input-name")))&&zt.multipleImages[l]){var r=(p=zt.multipleImages[l]).files.length-2,i=(v=isNaN(a)?0:Math.min(Math.max(a,0),r))+1,o=p.files[i];p.imageEditor&&i!==v&&(p.imageEditor.src=o.currentFile);var c=this.querySelector('button[data-previous="true"]'),d=this.querySelector('button[data-next="true"]');0===i&&(c&&c.setAttribute("disabled",""),d&&d.removeAttribute("disabled")),i===p.files.length-1&&(c&&c.removeAttribute("disabled"),d&&d.setAttribute("disabled","")),0!==i&&i!==p.files.length-1&&(d&&d.removeAttribute("disabled"),c&&c.removeAttribute("disabled"));var s=this.parentElement.querySelector('details[data-photo-text][data-index="'.concat(String(n)).concat('"]')),u=this.parentElement.querySelector('details[data-photo-text][data-index="'.concat(String(i)).concat('"]'));s&&s.setAttribute("hidden",""),u&&u.removeAttribute("hidden"),this.setAttribute("data-index",String(i))}}else if("back"===e){var l,p,v;if(n=String(this.getAttribute("data-index")),a=parseInt(n),(l=String(this.getAttribute("data-input-name")))&&zt.multipleImages[l])r=(p=zt.multipleImages[l]).files.length-1,i=(v=isNaN(a)?0:Math.min(Math.max(a,0),r))-1,o=p.files[i],p.imageEditor&&i!==v&&(p.imageEditor.src=o.currentFile),c=this.querySelector('button[data-previous="true"]'),d=this.querySelector('button[data-next="true"]'),0===i&&(c&&c.setAttribute("disabled",""),d&&d.removeAttribute("disabled")),i===p.files.length-1&&(c&&c.removeAttribute("disabled"),d&&d.setAttribute("disabled","")),0!==i&&i!==p.files.length-1&&(d&&d.removeAttribute("disabled"),c&&c.removeAttribute("disabled")),s=this.parentElement.querySelector('details[data-photo-text][data-index="'.concat(String(n)).concat('"]')),u=this.parentElement.querySelector('details[data-photo-text][data-index="'.concat(String(i)).concat('"]')),s&&s.setAttribute("hidden",""),u&&u.removeAttribute("hidden"),this.setAttribute("data-index",String(i))}}function se(t){var e=this.closest('div[data-wrapper="true"]');this.getAttribute("data-previous")?e&&e.dispatchEvent(new CustomEvent("nav-media",{detail:"back"})):this.getAttribute("data-next")&&e&&e.dispatchEvent(new CustomEvent("nav-media",{detail:"next"}))}function ue(t){var e=this.closest("output");if(e){var n=String(e.getAttribute("for")),a=document.querySelector('input[name="'.concat(n,'-text"]')),i=e.querySelector('div[data-input-name="'.concat(n,'"][data-wrapper="true"]'));if(i){var o=parseInt(String(i.getAttribute("data-index")));if(!isNaN(o)&&isFinite(o)){var c=zt.multipleImages[n];if(c)if(Boolean(1===c.files.length))delete zt.multipleImages[n],(0,r.bI)(e),a&&a.remove();else{var d=e.querySelector('div[data-wrapper="true"]'),s=e.querySelector('details[data-index="'.concat(o,'"]'));if(s&&s.remove(),0===o){c.files=c.files.slice(1),c.imageEditor&&(c.imageEditor.src=c.files[0].currentFile);for(var u=1;u<c.files.length+1;u++){var l=e.querySelector('details[data-index="'.concat(u,'"]'));l&&l.setAttribute("data-index",String(u-1))}(m=e.querySelector('details[data-index="0"]'))&&m.removeAttribute("hidden");var p=c.files[0].currentFile;c.imageEditor&&(c.imageEditor.src=p)}else if(o===c.files.length-1)c.files=c.files.slice(0,c.files.length-1),c.imageEditor&&(c.imageEditor.src=c.files[c.files.length-1].currentFile),d&&d.setAttribute("data-index",String(o-1)),(m=e.querySelector('details[data-index="'.concat(o-1,'"]')))&&m.removeAttribute("hidden"),p=c.files[o-1].currentFile,c.imageEditor&&(c.imageEditor.src=p);else{for(c.files=c.files.slice(0,o).concat(c.files.slice(o+1)),c.imageEditor&&(c.imageEditor.src=c.files[o].currentFile),u=o+1;u<c.files.length+1;u++){var v=e.querySelector('details[data-index="'.concat(u,'"]'));v&&v.setAttribute("data-index",String(u-1))}var m;(m=e.querySelector('details[data-index="'.concat(o,'"]')))&&m.removeAttribute("hidden"),p=c.files[o].currentFile,c.imageEditor&&(c.imageEditor.src=p)}a&&(a.value=c.files.map((function(t){return t.currentUrl.trim()})).join("|"))}}}}}function le(t){var e=this.closest("output");if(e){var n=String(e.getAttribute("for")),a=document.querySelector('input[name="'.concat(n,'-text"]'));zt.images[n]&&(delete zt.images[n],(0,r.bI)(e),a&&a.remove())}}function pe(t,e,n,a){return void 0===a&&(a=!1),Ut(this,void 0,void 0,(function(){var i,o,c,d,s,u,l,p,v,m,h,f,b,g,y,A,w,x,E,S,L,U,T;return Tt(this,(function(M){switch(M.label){case 0:if(i=n.hasAttribute("data-copy-url"),o=n.hasAttribute("data-prevent-default"),c=n.hasAttribute("multiple"),a||Yt(c?"Uploading Images...":"Uploading Image..."),d=String(n.getAttribute("name")),!t||!e)return[3,20];M.label=1;case 1:return M.trys.push([1,19,,20]),c&&t.length?(a||Yt("Uploading Images..."),zt.multipleImages[d]?[3,8]:(t.length>30&&re(5),u=Array.from(t).map((function(t){return t.name})).slice(0,30),!1!==a&&Array.isArray(a)?[3,3]:[4,Promise.all(Array.from(t).slice(0,30).map((function(t,e){return ie({name:u[e],file:t,initial:!0,multiple:!0,original:!0,previouslyUploaded:Boolean(a)})})))])):[3,9];case 2:return s=M.sent(),[3,4];case 3:s=a.map((function(e,n){return{imageUrl:e,type:t[n].type.replace("image/","")}})),M.label=4;case 4:return i||o?[3,6]:(s.length&&function(t,e,n){var a=document.createElement("div");a.className="flex-row align-center justify-between w-100 bb p-md mt-2",a.setAttribute("data-wrapper","true"),a.setAttribute("data-index","0"),a.setAttribute("data-input-name",e),a.addEventListener("nav-media",de);var r=document.createElement("button");r.setAttribute("tabindex","-1"),r.setAttribute("type","button"),r.setAttribute("data-previous","true"),r.className="filled icon small secondary",r.insertAdjacentHTML("afterbegin",'<svg focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="ArrowBack"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path></svg>'),r.addEventListener("click",se),r.setAttribute("disabled","");var i=document.createElement("button");i.setAttribute("tabindex","-1"),i.setAttribute("type","button"),i.className="filled icon small error",i.insertAdjacentHTML("afterbegin",'<svg focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="Delete"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path></svg>'),i.addEventListener("click",ue);var o=document.createElement("button");o.setAttribute("tabindex","-1"),o.setAttribute("type","button"),o.setAttribute("data-next","true"),o.className="filled icon small primary",o.insertAdjacentHTML("afterbegin",'<svg focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="ArrowForward"><path d="m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"></path></svg>'),o.addEventListener("click",se),1===n&&(o.setAttribute("disabled",""),r.setAttribute("disabled","")),a.append(r),a.append(i),a.append(o),t.append(a)}(e,d,t.length),a||Zt(),l=[],s.forEach((function(e,n){e&&l.push({name:u[n],currentUrl:e.imageUrl,currentFile:structuredClone(Array.from(t)[n]),type:e.type,inputName:d})})),(S=document.createElement("input")).setAttribute("type","text"),S.setAttribute("hidden",""),S.setAttribute("name",d.concat("-text")),S.value=l.map((function(t){return t.currentUrl.trim()})).join("|"),n.insertAdjacentElement("afterend",S),(E=document.createElement("div")).className="image-editor-pintura",e.append(E),s.forEach((function(t,n){t&&e.insertAdjacentElement("beforeend",$t(t.imageUrl,n,Boolean(0!==n)))})),(0,r.KT)(e),[4,ce(E,t[0],l[0].type,d,Boolean(a))]);case 5:return(L=M.sent())&&(zt.multipleImages[d]={input:S,files:l,imageEditor:L}),[3,7];case 6:i&&(a||Zt(),p=s.map((function(t,e){return{filename:t.imageUrl,originalFilename:u[e]}})),Gt(e,0,p)),M.label=7;case 7:s&&n.dispatchEvent(jt(0,s.filter((function(t){return t})).map((function(t){return{url:t.imageUrl}})))),M.label=8;case 8:return[3,18];case 9:return 1===t.length&&e?(a||Yt("Uploading Image..."),v=t[0].name,m=t[0],h=null,!1===a||Array.isArray(a)?[4,ie({name:v,file:m,initial:!0,original:!0,previouslyUploaded:Boolean(a)})]:[3,11]):[3,18];case 10:return h=M.sent(),[3,12];case 11:h={imageUrl:a,type:m.type.replace("image/","")},M.label=12;case 12:return!h||i||o?[3,16]:(f=h.imageUrl,b=h.type,zt.images[d]&&f?(zt.images[d].currentUrl=f,(g=document.querySelector('input[name="'.concat(d,'-text"]')))&&(g.value=f),zt.images[d].currentFile=m,y=e.querySelector('input[name="'.concat(d.concat("-short-description")).concat('"]')),A=e.querySelector('textarea[name="'.concat(d.concat("-long-description")).concat('"]')),y&&(y.value=""),A&&(A.value=""),zt.images[d].imageEditor&&(zt.images[d].imageEditor.src=m),[3,15]):[3,13]);case 13:return f?((w=document.createElement("div")).classList.add("flex-row","justify-end","align-center","bb","p-sm"),(x=document.createElement("button")).setAttribute("tabindex","-1"),x.setAttribute("type","button"),x.className="filled small icon error",x.insertAdjacentHTML("afterbegin",'<svg focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="Delete"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path></svg>'),x.addEventListener("click",le),w.append(x),e.append(w),(E=document.createElement("div")).className="image-editor-pintura",e.append(E),(S=document.createElement("input")).setAttribute("type","text"),S.setAttribute("readonly",""),S.setAttribute("name",d.concat("-text")),S.setAttribute("hidden",""),S.value=f,n.insertAdjacentElement("afterend",S),zt.images[d]={name:v,currentUrl:f,index:0,imageEditor:void 0,type:b,currentFile:structuredClone(m)},[4,ce(E,m,0,d,Boolean(a))]):[3,15];case 14:(L=M.sent())&&(zt.images[d].imageEditor=L),E.insertAdjacentElement("afterend",$t(d,0,!1)),(0,r.KT)(e),M.label=15;case 15:return[3,17];case 16:h&&i&&(a||Zt(),U={filename:h.imageUrl,originalFilename:m.name},Gt(e,0,U)),M.label=17;case 17:h&&n.dispatchEvent(jt(0,[{url:h.imageUrl}])),M.label=18;case 18:return[3,20];case 19:return T=M.sent(),console.error(T),[3,20];case 20:return a||Zt(),[2]}}))}))}function ve(t){return Ut(this,void 0,void 0,(function(){var e,n,a;return Tt(this,(function(r){switch(r.label){case 0:return t.preventDefault(),e=String(this.getAttribute("name")),n=this.files,a=document.querySelector('output[for="'.concat(e).concat('"]')),n&&a?[4,pe(Array.from(n),a,this)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}function me(t){var e=t.detail.inputName;if(e){var n=document.querySelector('input[type="file"][name="'.concat(e,'"]'));if(n)if(n.hasAttribute("multiple"))zt.multipleImages[e]&&delete zt.multipleImages[e];else for(var a=0,r=Object.keys(zt.images);a<r.length;a++){var i=r[a];zt.images[i]&&delete zt.images[i]}}}function he(t){var e=this.closest("div[data-media-output-wrapper]");e&&e.remove();var n=this.closest("output");if(n){var a=n.querySelector("audio, video"),r=n.querySelector("p[data-media-output-header]");!a&&r&&r.remove()}}function fe(t,e){var n=document.createElement("div");n.setAttribute("data-media-output-wrapper",""),n.style.borderBottom="1px solid var(--divider)",n.style.paddingBottom="6px";var a=document.createElement("div");a.className="flex-row justify-end align-center",a.style.paddingBottom="2px";var r=document.createElement("button");r.setAttribute("type","button"),r.className="icon small filled error",r.insertAdjacentHTML("afterbegin",'<svg focusable="false" inert viewBox="0 0 24 24" tabindex="-1" title="Delete"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path></svg>'),r.addEventListener("click",he),a.append(r),n.append(a),n.insertAdjacentHTML("beforeend",t),e.append(n)}function be(t,e,n){var a=document.createElement("p");a.style.cssText="margin-bottom: 6px;",a.classList.add("h5","bold","bb"),a.setAttribute("data-media-output-header",""),"audio"===t?a.innerText=e?"Audio Outputs:":"Audio Output:":"video"===t&&(a.innerText=e?"Video Outputs:":"Video Output:"),n.append(a)}function ge(t){var e=document.getElementById("video-error-popover");"false"!==(e?e.getAttribute("aria-hidden"):"true")&&e&&(Array.from(e.querySelectorAll("span[data-error]")).forEach((function(e){e.getAttribute("data-error")===String(t)?e.removeAttribute("hidden"):e.setAttribute("hidden","")})),(0,r.Gm)(e))}function ye(t){try{var e=t.name;if(!t.type.startsWith("video/",0))throw new Error("1");var n=_t(e);if(!Bt.has(n))throw new Error("2");if(t.size>Ct)throw new Error("3");return{file:t,name:e,size:Math.ceil(t.size/Vt)}}catch(t){var a=parseInt(t.message);return isNaN(a)?ge(4):ge(a),null}}function Ae(t,e,n,a){return void 0===a&&(a=!1),Ut(this,void 0,void 0,(function(){var a,i,o,c,d,s,u,l,p,v,m,h,f,b,g,y,A,w,x,E,S,L,U,T,M,k,z,I,H,q,C,V;return Tt(this,(function(N){switch(N.label){case 0:a=e.hasAttribute("data-copy-url"),i=e.hasAttribute("data-prevent-default"),o=Boolean(e.hasAttribute("multiple")),N.label=1;case 1:return N.trys.push([1,15,,16]),o&&t?(c=Array.from(t).map((function(t){return ye(t)})).filter((function(t){return null!==t}))).length?(Yt("Uploading Videos..."),[4,Promise.all(c.slice(0,10).map((function(t){return Ft(t.file)})))]):[3,6]:[3,8];case 2:return d=N.sent(),[4,Promise.all(c.slice(0,10).map((function(t,e){var n;return fetch("/api/signed-url/video/".concat(encodeURIComponent(t.name)).concat("/").concat(String(t.size).concat("?height=".concat((null===(n=d[e])||void 0===n?void 0:n.height)||null,"&size=").concat(t.file.size)))).then((function(t){if(200!==t.status)throw new Error("Network request");return t.json()})).then((function(t){return t}))})))];case 3:for(s=N.sent(),U=[],u=c.map((function(t){return 0})),l=0,z=0;z<s.length;z++)l=Math.max(l,s[z].urls.length);for(p=function(t){for(var e=function(e){U.push(fetch(s[t].urls[e],{method:"PUT",body:c[t].file.slice(Vt*e,Vt*(e+1))}).then((function(n){if(200!==n.status)throw new Error("Network request");if(e+1>u[t]){u[t]=e+1;var a="Video Uploads Percent Complete: ".concat(String(100*Math.min.apply(Math,u)/l).slice(0,5)).concat("%");(0,r.A3)(a)}return{ETag:n.headers.get("ETag")||n.headers.get("Etag"),PartNumber:e+1}})))},n=0;n<s[t].urls.length;n++)e(n)},v=0;v<s.length;v++)p(v);return[4,Promise.all(U)];case 4:for(I=N.sent(),m=[],h=0,f=0;f<c.length;f++)b=s[f],x=b.Key,g=b.UploadId,y=c[f].size,A=I.slice(h,h+y),h+=y,m.push(fetch("/api/complete-video",{method:"POST",body:JSON.stringify({Parts:A,UploadId:g,Key:x}),headers:{"Content-Type":"application/json","X-CSRF-Token":(0,r.Qm)()}}).then((function(t){if(200!==t.status)throw new Error("Network request");return t.json()})));return[4,Promise.all(m)];case 5:if(w=N.sent(),Zt(),a||i)a&&(Zt(),q=s.map((function(t){return Qt("https://video.storething.org/".concat(t.Key)).videoSources.map((function(t){return t.src}))})).flat(1),Jt(n,0,q));else if(n){for((0,r.bI)(n),be("video",!1,n),z=0;z<s.length;z++)x=s[z].Key,fe(ee("https://video.storething.org/".concat(x),void 0,String(w[z].height)),n);(0,r.KT)(n),n.scrollIntoView(kt)}return e.dispatchEvent(jt(0,s.map((function(t){return{url:"https://video.storething.org/".concat(t.Key)}})))),[3,7];case 6:throw new Error("4");case 7:return[3,14];case 8:return t?(E=ye(t[0]))?(Yt("Uploading Video..."),[4,Ft(E.file)]):[3,13]:[3,14];case 9:return S=N.sent(),[4,fetch("/api/signed-url/video/".concat(encodeURIComponent(E.name)).concat("/").concat(String(E.size)).concat("?height=".concat((null==S?void 0:S.height)||null,"&size=").concat(E.file.size))).then((function(t){if(200!==t.status)throw new Error("Network request");return t.json()})).then((function(t){return t}))];case 10:for(L=N.sent(),U=[],T=0,M=L.urls.length,k=function(t){if(!L.urls[t])throw new Error("4");U.push(fetch(L.urls[t],{method:"PUT",body:E.file.slice(Vt*t,Vt*(t+1))}).then((function(e){if(200!==e.status)throw new Error("Network request");if(t+1>T){T=t+1;var n="Video Upload Percent Complete: ".concat(String(100*T/M).slice(0,5)).concat("%");(0,r.A3)(n)}return{ETag:e.headers.get("ETag")||e.headers.get("Etag"),PartNumber:t+1}})))},z=0;z<L.urls.length;z++)k(z);return[4,Promise.all(U)];case 11:return I=N.sent(),[4,fetch("/api/complete-video",{method:"POST",body:JSON.stringify({Parts:I,UploadId:L.UploadId,Key:L.Key}),headers:{"Content-Type":"application/json","X-CSRF-Token":(0,r.Qm)()}}).then((function(t){if(200!==t.status)throw new Error("Network request");return t.json()}))];case 12:return H=N.sent().height,Zt(),a||i?a&&(Zt(),q=Qt("https://video.storething.org/".concat(L.Key)),Jt(n,0,q.videoSources.map((function(t){return t.src})))):n&&((0,r.bI)(n),be("video",!0,n),fe(ee("https://video.storething.org/".concat(L.Key),void 0,String(H)),n),(0,r.KT)(n),n.scrollIntoView(kt)),e.dispatchEvent(jt(0,[{height:H,url:"https://video.storething.org/".concat(L.Key)}])),[3,14];case 13:throw new Error("4");case 14:return[3,16];case 15:return C=N.sent(),Zt(),V=parseInt(C.message),isNaN(V)?ge(4):ge(V),[3,16];case 16:return[2]}}))}))}function we(t){return Ut(this,void 0,void 0,(function(){var e,n,a;return Tt(this,(function(r){switch(r.label){case 0:return t.preventDefault(),e=this.files,n=String(this.getAttribute("name")),a=document.querySelector('output[for="'.concat(n).concat('"]')),e&&n&&a?[4,Ae(e,this,a)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}function xe(t){var e=document.getElementById("audio-error-popover");"false"!==(e?e.getAttribute("aria-hidden"):"true")&&e&&(Array.from(e.querySelectorAll("span[data-error]")).forEach((function(e){e.getAttribute("data-error")===String(t)?e.removeAttribute("hidden"):e.setAttribute("hidden","")})),(0,r.Gm)(e))}function Ee(t){try{var e=t.name;if(!t.type.startsWith("audio/",0)&&!t.type.startsWith("video/",0))throw new Error("1");var n=_t(t.name);if(!Nt.has(n))throw new Error("2");if(t.size>qt)throw new Error("3");return{file:t,name:e,size:Math.ceil(t.size/Vt)}}catch(t){var a=parseInt(t.message);return isNaN(a)?xe(4):xe(a),null}}function Se(t,e,n,a){return void 0===a&&(a=!1),Ut(this,void 0,void 0,(function(){var a,i,o,c,d,s,u,l,p,v,m,h,f,b,g,y,A,w,x,E,S,L,U,T,M,k,z,I,H;return Tt(this,(function(q){switch(q.label){case 0:a=e.hasAttribute("data-copy-url"),i=e.hasAttribute("data-prevent-default"),o=Boolean(e.hasAttribute("multiple")),document.querySelector("html"),q.label=1;case 1:return q.trys.push([1,13,,14]),o&&t?(c=Array.from(t).map((function(t){return Ee(t)})).filter((function(t){return null!==t}))).length?(Yt("Uploading Audio Files..."),[4,Promise.all(c.slice(0,10).map((function(t){return fetch("/api/signed-url/audio/".concat(encodeURIComponent(t.name)).concat("/").concat(String(t.size)).concat("?size=".concat(t.file.size))).then((function(t){if(200!==t.status)throw new Error("Network request");return t.json()})).then((function(t){return t}))})))]):[3,5]:[3,7];case 2:for(d=q.sent(),x=[],s=c.slice(0,10).map((function(t){return 0})),u=0,U=0;U<d.length;U++)u=Math.max(u,d[U].urls.length);for(l=function(t){for(var e=function(e){x.push(fetch(d[t].urls[e],{method:"PUT",body:c[t].file.slice(Vt*e,Vt*(e+1))}).then((function(n){if(200!==n.status)throw new Error("Network request");if(e+1>s[t]){s[t]=e+1;var a="Audio Uploads Percent Complete: ".concat(Number(100*Math.min.apply(Math,s)/u).toFixed(3)).concat("%");(0,r.A3)(a)}return{ETag:n.headers.get("ETag")||n.headers.get("Etag"),PartNumber:e+1}})))},n=0;n<d[t].urls.length;n++)e(n)},p=0;p<d.length;p++)l(p);return[4,Promise.all(x)];case 3:for(T=q.sent(),v=[],m=0,h=0;h<c.length;h++)f=d[h],M=f.Key,b=f.UploadId,g=c[h].size,y=T.slice(m,m+g),m+=g,v.push(fetch("/api/complete-audio",{method:"POST",body:JSON.stringify({Parts:y,UploadId:b,Key:M}),headers:{"Content-Type":"application/json","X-CSRF-Token":(0,r.Qm)()}}).then((function(t){if(200!==t.status)throw new Error("Network request")})));return[4,Promise.all(v)];case 4:if(q.sent(),Zt(),a||i)a&&(Zt(),z=d.map((function(t){return Xt("https://audio.storething.org/".concat(t.Key)).audioSources.map((function(t){return t.src}))})).flat(1),Jt(n,0,z));else if(n){for((0,r.bI)(n),be("audio",!1,n),U=0;U<d.length;U++)M=d[U].Key,fe(te("https://audio.storething.org/".concat(M)),n);(0,r.KT)(n),n.scrollIntoView(kt)}return e.dispatchEvent(jt(0,d.map((function(t){return{url:"https://audio.storething.org/".concat(t.Key)}})))),[3,6];case 5:throw new Error("4");case 6:return[3,12];case 7:return t?(A=Ee(t[0]))?(Yt("Uploading Audio..."),[4,fetch("/api/signed-url/audio/".concat(encodeURIComponent(A.name)).concat("/").concat(String(A.size)).concat("?size=".concat(A.file.size))).then((function(t){if(200!==t.status)throw new Error("Network request");return t.json()})).then((function(t){return t}))]):[3,11]:[3,12];case 8:for(w=q.sent(),x=[],E=0,S=w.urls.length,L=function(t){if(!w.urls[t])throw new Error("4");x.push(fetch(w.urls[t],{method:"PUT",body:A.file.slice(Vt*t,Vt*(t+1))}).then((function(e){if(200!==e.status)throw new Error("Network request");if(t+1>E){E=t+1;var n="Audio Upload Percent Complete: ".concat(String(100*E/S).slice(0,5)).concat("%");(0,r.A3)(n)}return{ETag:e.headers.get("ETag")||e.headers.get("Etag"),PartNumber:t+1}})))},U=0;U<w.urls.length;U++)L(U);return[4,Promise.all(x)];case 9:return T=q.sent(),[4,fetch("/api/complete-audio",{method:"POST",body:JSON.stringify({Parts:T,UploadId:w.UploadId,Key:w.Key}),headers:{"Content-Type":"application/json","X-CSRF-Token":(0,r.Qm)()}}).then((function(t){if(200!==t.status)throw new Error("Network request")}))];case 10:return q.sent(),Zt(),a||i?a&&(Zt(),M=w.Key,k=Xt("https://audio.storething.org/".concat(M)).audioSources,z=k.map((function(t){return t.src})),Jt(n,0,z)):n&&((0,r.bI)(n),be("audio",!0,n),fe(te("https://audio.storething.org/".concat(w.Key)),n),(0,r.KT)(n),n.scrollIntoView(kt)),e.dispatchEvent(jt(0,[{url:"https://audio.storething.org/".concat(w.Key)}])),[3,12];case 11:throw new Error("4");case 12:return[3,14];case 13:return I=q.sent(),Zt(),H=parseInt(I.message),isNaN(H)?xe(4):xe(H),[3,14];case 14:return[2]}}))}))}function Le(t){return Ut(this,void 0,void 0,(function(){var e,n,a;return Tt(this,(function(r){switch(r.label){case 0:return t.preventDefault(),e=this.files,n=String(this.getAttribute("name")),a=document.querySelector('output[for="'.concat(n).concat('"]')),e&&n&&a?[4,Se(e,this,a)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}function Ue(t){return Ut(this,void 0,void 0,(function(){var t,e,n,a,r,i,o=this;return Tt(this,(function(c){switch(c.label){case 0:if(!(t=this.files))return[3,5];c.label=1;case 1:return c.trys.push([1,4,,5]),e=[],e=this.hasAttribute("multiple")?Array.from(t).slice(0,30):Array.from(t).slice(0,1),Yt("Uploading GIF..."),n=[],[4,Promise.all(e.filter((function(t){try{var e=t.type;if(!e.startsWith("image/",0))throw new Error("1");var a=e.replace("image/","");if(t.size>Ht)throw new Error("2");if("gif"!==a)throw new Error("3");return n.push(t),!0}catch(t){return re(parseInt(t.message)),!1}})).map((function(t){return Ut(o,void 0,void 0,(function(){var e;return Tt(this,(function(n){switch(n.label){case 0:return[4,Wt(t)];case 1:return e=n.sent(),[2,fetch("/api/signed-url/image/".concat(encodeURIComponent(t.name)).concat("?size=".concat(t.size,"&height=").concat(e.height,"&width=").concat(e.width))).then((function(t){if(200!==t.status)throw new Error("Network request");return t.json()})).then((function(t){return t.url}))]}}))}))})))];case 2:return a=c.sent(),[4,Promise.all(a.map((function(t,e){return fetch(t,{method:"PUT",headers:{"Content-Type":"multipart/form-data"},body:n[e]}).then((function(t){if(200!==t.status)throw new Error("Network request")}))})))];case 3:return c.sent(),r=a.map((function(t){var e=new URL(t);return"https://image.storething.org".concat(e.pathname)})),Zt(),this.setAttribute("data-uploads",r.join("|")),this.dispatchEvent(new CustomEvent("gif-upload",{detail:{urls:r}})),[3,5];case 4:return i=c.sent(),console.error(i),Zt(),[3,5];case 5:return[2]}}))}))}function Te(){var t=this;Lt();var e=Array.from(document.querySelectorAll('input[type="file"][data-image-input]:not([data-ignore-change])')),n=Array.from(document.querySelectorAll('input[type="file"][accept=".gif"]:not([data-ignore-change])')),a=Array.from(document.querySelectorAll('input[type="file"][data-audio-input]:not([data-ignore-change])')),i=Array.from(document.querySelectorAll('input[type="file"][data-video-input]:not([data-ignore-change])'));e.forEach((function(e){return Ut(t,void 0,void 0,(function(){var t,n,a,r,i,o,c,d,s,u,l,p,v;return Tt(this,(function(m){switch(m.label){case 0:if(e.addEventListener("change",ve),e.addEventListener("delete-image",me),t=String(e.getAttribute("name")),n=String(e.id),a=document.querySelector('output[for="'.concat(n,'"]')),r=e.getAttribute("data-default-value"),e.removeAttribute("data-default-value"),i=e.hasAttribute("multiple"),!r||!a||""!==a.innerText.trim())return[3,10];m.label=1;case 1:return m.trys.push([1,8,,9]),o=JSON.parse(decodeURIComponent(r)),c=[],i?[4,Promise.all(o.map((function(t){return fetch(t.src).then((function(t){if(200!==t.status)throw new Error("Network request");return t.blob()})).then((function(e){var n=t.src.replace("https://image.storething.org/frankmbrown/",""),a=n.lastIndexOf("."),r="image/".concat(n.slice(a+1)),i=new File([e],n,{type:r});c.push(i)})).catch((function(t){return console.error(t)}))})))]:[3,4];case 2:return m.sent(),[4,pe(c,a,e,o.map((function(t){return t.src})))];case 3:for(m.sent(),d=0,s=o;d<s.length;d++)u=s[d],l=document.querySelector('input[type="text"][id="'.concat(u.src,'-short-description"]')),p=document.querySelector('input[type="text"][id="'.concat(u.src,'-long-description"]')),l&&(l.value=u.shortDescription),p&&(p.value=u.longDescription);return[3,7];case 4:return[4,fetch(o[0].src).then((function(t){if(200!==t.status)throw new Error("Network request");return t.blob()})).then((function(t){var e=o[0].src.replace("https://image.storething.org/frankmbrown/",""),n=e.lastIndexOf("."),a="image/".concat(e.slice(n+1)),r=new File([t],e,{type:a});c.push(r)})).catch((function(t){return console.error(t)}))];case 5:return m.sent(),[4,pe(c,a,e,o[0].src)];case 6:m.sent(),l=document.querySelector('input[type="text"][id="'.concat(t,'-short-description"]')),p=document.querySelector('input[type="text"][id="'.concat(t,'-long-description"]')),l&&(l.value=o[0].shortDescription),p&&(p.value=o[0].longDescription),m.label=7;case 7:return[3,9];case 8:return v=m.sent(),console.error(v),[3,9];case 9:a.style.removeProperty("min-height"),m.label=10;case 10:return[2]}}))}))})),a.forEach((function(t){t.addEventListener("change",Le);var e=String(t.id),n=document.querySelector('output[for="'.concat(e,'"]')),a=t.getAttribute("data-default-value");t.removeAttribute("data-default-value");var r=t.hasAttribute("multiple");if(a&&n&&""===n.innerText.trim()){try{var i=JSON.parse(decodeURIComponent(a));if(Array.isArray(i)){var o=i.filter((function(t){return Boolean("string"==typeof t.src&&t.src.startsWith("https://audio.storething.org/")&&"string"==typeof t.title)}));if(o.length)if(r){be("audio",!0,n);for(var c=0,d=o;c<d.length;c++){var s=d[c];fe(te(s.src,void 0),n),ne(s.src,s.title,n)}}else fe(te(o[0].src,void 0),n),ne(o[0].src,o[0].title,n)}}catch(t){console.error(t)}n.style.removeProperty("min-height")}})),i.forEach((function(t){t.addEventListener("change",we);var e=String(t.id),n=document.querySelector('output[for="'.concat(e,'"]')),a=t.getAttribute("data-default-value");t.removeAttribute("data-default-value");var i=t.hasAttribute("multiple");if(a&&n&&""===n.innerText.trim()){try{(0,r.bI)(n);var o=JSON.parse(decodeURIComponent(a));if(Array.isArray(o)){var c=o.filter((function(t){return Boolean("string"==typeof t.src&&t.src.startsWith("https://video.storething.org/")&&"string"==typeof t.title&&"string"==typeof t.description&&"number"==typeof t.height)}));if(c.length)if(i){be("video",!0,n);for(var d=0,s=c;d<s.length;d++){var u=s[d];fe(ee(u.src,void 0,String(u.height)),n),ae(u.src,u.title,u.description,n)}}else be("video",!1,n),ae(c[0].src,c[0].title,c[0].description,n)}}catch(t){console.error(t)}n.style.removeProperty("min-height")}})),n.forEach((function(t){t.addEventListener("change",Ue)}))}function Me(){zt.images={},zt.multipleImages={}}function ke(t,e){return e&&zt.multipleImages[t],zt.images[t]}window.handlePageChangeMediaInputs=Me}}]);